# -*- coding: utf-8 -*-
"""Untitled4.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1CCPD7Antu3Z0KPEmgFdo6nywNuGm4i2f
"""

import kagglehub

# Download latest version
path = kagglehub.dataset_download("ardutraagiginting/exam-cheating-dataset")

print("Path to dataset files:", path)

from tensorflow.keras.preprocessing.image import ImageDataGenerator
datagen = ImageDataGenerator(
    rescale=1./255,  # Normalize pixel values to [0, 1]
    rotation_range=20,
    width_shift_range=0.2,
    height_shift_range=0.2,
    shear_range=0.2,
    zoom_range=0.2,
    horizontal_flip=True,
    fill_mode='nearest'
)
train_generator = datagen.flow_from_directory(
    path+"/ExamCheatingDataset",  # Path to the directory containing class subdirectories
    target_size=(100, 100),    # All images will be resized to this size
    batch_size=32,             # Number of images to yield per batch
    class_mode='categorical'   # For multi-class classification; 'binary' for two classes, None for regression
)

import keras
from keras.layers import Dense, Input, Flatten, Conv2D, BatchNormalization, MaxPool2D
model = keras.models.Sequential()
model.add(Input(shape=(100, 100, 3)))
model.add(Conv2D(16, (3, 3), (1, 1)))
model.add(MaxPool2D((3,3)))
model.add(BatchNormalization())
model.add(Flatten())
model.add(Dense(512, activation = "relu"))
model.add(BatchNormalization())
model.add(Dense(2, activation = "softmax"))
model.summary()

model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])

model.fit(train_generator, epochs=150)
